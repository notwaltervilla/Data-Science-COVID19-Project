---
title: "air_quality_jonas"
author: "Jonas"
date: "10/20/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

```



```{r load data}

#Loading EPA Air Quality Data
df_airquality2020<- read.csv("./data/annual_aqi_by_county_2020.csv")
df_airquality2020

#Load NYTimes Data - using code from c06
url_counties <- "https://raw.githubusercontent.com/nytimes/covid-19-data/master/live/us-counties.csv"
filename_nyt <- "./data/nyt_counties.csv"

## Download the data locally
curl::curl_download(
        url_counties,
        destfile = filename_nyt
      )

## Loads the downloaded csv
df_covid <- read_csv(filename_nyt)
df_covid
```


```{r wrangling data}
names(df_covid)[2] <- "County"
names(df_covid)[3] <- "State"
df_covid_air <- inner_join(df_covid, df_airquality2020, by = c("County", "State"))
df_covid_air #This is the joined version of the COVID-19 and EPA data set

```

```{r}
df_pm25 <- read_csv("./data/pm25.csv")
df_pm25
```
  group_by(fips) %>% 
  summarize(mean_pm25 = mean(pm25)) %>% 

  mutate(fips = filter(
                        nchar(fips) == 4
                )
           paste("0", fips, sep = "")
  ) %>%
  
  arrange((fips))


```{r}
df_covid_air %>%
  filter(State == "Alabama")  %>%
  summarise(Air_Quality_Index = Median.AQI, Cases = cases, County = County) %>%
  ggplot() +
  geom_point(aes(Air_Quality_Index, Cases, color = County))
  
 # ggplot() +
 # geom_line(aes("Median.AQI", "confirmed_cases", color = County))


```



```{r}
df_covid_air %>%
  summarise(
    Air_Quality_Index = Median.AQI,
    Cases = cases,
    County = County,
    State = State) %>%
  ggplot() +
  geom_point(aes(Air_Quality_Index, Cases, color = State)) +
  scale_y_log10()
df_covid_air %>%
  summarise(
    Air_Quality_Index = Median.AQI,
    Deaths = deaths,
    County = County,
    State = State) %>%
  ggplot() +
  geom_point(aes(Air_Quality_Index, Deaths, color = State)) +
  scale_y_log10()
```
 
```{r}
df_covid_air %>%
  filter(State == "California") %>%
  summarise(
    Air_Quality_Index = Median.AQI,
    Cases = cases,
    County = County,
    State = State) %>%
  ggplot() +
  geom_point(aes(Air_Quality_Index, Cases, color = County)) +
  scale_y_log10()
df_covid_air %>%
  filter(State == "New York") %>%
  summarise(
    Air_Quality_Index = Median.AQI,
    Cases = cases,
    County = County,
    State = State) %>%
  ggplot() +
  geom_point(aes(Air_Quality_Index, Cases, color = County)) +
  scale_y_log10()
df_covid_air %>%
  filter(State == "Florida") %>%
  summarise(
    Air_Quality_Index = Median.AQI,
    Deaths = deaths,
    County = County,
    State = State) %>%
  ggplot() +
  geom_point(aes(Air_Quality_Index, Deaths, color = County)) +
  scale_y_log10()
```





